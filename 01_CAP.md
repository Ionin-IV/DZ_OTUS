# Домашнее задание по лекции "CAP теорема"

## Задание

Необходимо написать к каким системам по CAP теореме относятся перечисленные БД и почему:
MongoDB, MSSQL, Cassandra.

## Ответ

MongoDB, в зависимости от настроек, я отношу к системе СР или АР, т.к.:
- Работа с кластером идёт строго через мастера. Однако, репликация асинхронная, а значит, при падении мастера и переключении на реплику, на последней могут быть не все данные. То же самое, если настроить чтение с реплик. Но возможно настроить уровень согласованности. Значит С или не С.
- Возможен доступ к кластеру, при недоступных узлах. Для этого настраиваются Replica-Sets. Но при этом теряются данные, которые не успели дойти с упавшего мастера. Значит А или не А.
- При разрыве сети, кластер будет работать, если количество узлов больше половины. Если меньше половины, то данные будут доступны только на чтение. Значит Р.

MSSQL (в варианте групп доступности AlwaysOn, как наиболее соответствующем распределённому кластеру) я отношу к системе CA, т.к.:
- Узлы содержат одинаковые данные. Значит С.
- Возможен доступ к "кластеру", при недоступных узлах. Значит А.
- Узлы не могут продолжать одновременно работать при разрыве сети, т.к. это будет split-brain. Значит не Р.

Примечание по MSSQL:
- Вариант классического отказоустойчивого кластера не рассматриваю, т.к. при этом нет распределения данных. По факту, есть одно хранилище с набором дисков, которые, в случае падения сервера с активным экземпляром СУБД, переключаются к другому серверу, где запускается свой экземпляр.
- Вариант зеркалирования тоже не рассматриваю, т.к. при этом идёт репликация данных только выбранных БД. Соответственно, при потере основного сервера, на зеркалах мы не получим его полную рабочую копию.

Cassandra, в зависимости от требуемого уровня согласованности, я отношу к системе AP или СР, т.к.:
- В запросе можно указывать уровень согласованности. В зависимости от этого можно получить, как согласованные, так и не согласованные данные. Значит может быть С или не С.
- Возможен доступ к кластеру, при недоступных узлах. С другой стороны, если в запросе требуется высокий уровень согласованности, то может не хватить необходимого количества доступных узлов. Значит может быть А или не А
- Узлы продолжают работать даже если есть недоступность по сети, а после восстановления сбоя сети, данные синхронизируются. Значит Р.
